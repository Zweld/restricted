
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Access Denied</title>
<style>
    :root { --bg:#0d1117; --panel:#161b22; --border:#30363d; --text:#c9d1d9; --accent:#58a6ff; --danger:#ff4d4d; --muted:#8b949e; }
    * { box-sizing: border-box; }
    body {
        background-color: var(--bg);
        color: var(--text);
        font-family: "Courier New", monospace;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
        padding: 16px;
    }
    .card {
        width: 100%;
        max-width: 720px;
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 28px;
        box-shadow: 0 0 28px rgba(0,0,0,0.55);
        text-align: center;
    }
    .title {
        font-size: 26px;
        font-weight: 800;
        color: var(--danger);
        letter-spacing: .5px;
        margin: 0 0 8px;
        text-transform: uppercase;
    }
    .subtitle {
        margin: 0 0 18px;
        color: var(--text);
        font-size: 16px;
        opacity: .9;
    }
    .terminal {
        text-align: left;
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 16px;
        min-height: 140px;
        overflow: hidden;
        position: relative;
    }
    .prompt { color: var(--accent); }
    .cursor {
        display: inline-block;
        width: 10px;
        animation: blink 1s infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }
    .footer {
        margin-top: 14px;
        color: var(--muted);
        font-size: 12px;
    }
    .badge {
        display: inline-block;
        margin-top: 10px;
        padding: 4px 8px;
        border: 1px solid var(--border);
        border-radius: 999px;
        font-size: 12px;
        color: var(--muted);
    }
</style>
</head>
<body>
<div class="card">
    <div class="title">ACCESS DENIED — CODE 403-R</div>
    <p class="subtitle">This site is restricted. Visitor metadata has been logged locally.</p>
    <div class="terminal" id="terminal" aria-live="polite"></div>
    <div class="badge" id="status">Collecting client data…</div>
    <div class="footer">© Security Gateway 2025</div>
</div>

<script>
/**
 * This page fetches *client-side* info using a public IP API (ipapi.co) and browser APIs.
 * Nothing is stored or sent anywhere else.
 */

const term = document.getElementById("terminal");
const statusEl = document.getElementById("status");

const sleep = (ms) => new Promise(r => setTimeout(r, ms));

function type(text, delay=11) {
  return new Promise(async (resolve) => {
    for (let ch of text) {
      term.insertAdjacentHTML("beforeend", ch === "\n" ? "<br>" : ch);
      await sleep(delay);
    }
    resolve();
  });
}

function line(text) {
  term.insertAdjacentHTML("beforeend", text + "<br>");
}

// Build local browser info
function getLocalInfo() {
  const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || "Unknown";
  const ua = navigator.userAgent;
  const lang = navigator.language || "en";
  const screenSize = (window.screen && window.screen.width) ? `${window.screen.width}x${window.screen.height}` : "Unknown";
  const viewport = `${Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0)}x${Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0)}`;
  return { tz, ua, lang, screenSize, viewport };
}

async function fetchIpInfo() {
  try {
    const res = await fetch("https://ipapi.co/json/");
    if (!res.ok) throw new Error("IP API error");
    return await res.json();
  } catch (e) {
    return { error: e.message };
  }
}

(async function main(){
  const start = new Date().toISOString();
  await type(`<span class="prompt">$</span> initializing security context…<br>`);
  await sleep(200);

  const local = getLocalInfo();
  const ipInfo = await fetchIpInfo();

  const data = {
    status: "restricted",
    timestamp: start,
    ip: ipInfo.ip || "unknown",
    city: ipInfo.city || "unknown",
    region: ipInfo.region || ipInfo.region_code || "unknown",
    country: ipInfo.country_name || ipInfo.country || "unknown",
    isp: ipInfo.org || "unknown",
    latitude: ipInfo.latitude || "unknown",
    longitude: ipInfo.longitude || "unknown",
    timezone_from_ip: ipInfo.timezone || "unknown",
    browser_language: local.lang,
    timezone_client: local.tz,
    user_agent: local.ua,
    screen: local.screenSize,
    viewport: local.viewport,
    sessionId: Math.random().toString(36).substring(2,12).toUpperCase(),
    note: "Local display only. No data stored."
  };

  // Pretty JSON with typing effect
  await type(`<span class="prompt">$</span> compiling visitor metadata…<br>`);
  await sleep(250);
  await type("{<br>");
  const entries = Object.entries(data);
  for (let i = 0; i < entries.length; i++) {
    const [k, v] = entries[i];
    const lineText = `  "${k}": "${String(v).replace(/"/g, '\\"')}"${i < entries.length - 1 ? "," : ""}<br>`;
    await type(lineText, 6);
  }
  await type("}<span class='cursor'>_</span>");
  statusEl.textContent = ipInfo.error ? "Done (IP API failed; showed local info)" : "Done (live IP + local info)";
})();
</script>
</body>
</html>
